<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8" />
<title>ç‹æ€»ç”Ÿæ—¥å¿«ä¹ ğŸ†ğŸ‚</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body {
    font-family: "Microsoft YaHei", -apple-system, BlinkMacSystemFont, sans-serif;
    background: radial-gradient(circle at top, #1b2735, #090a0f);
    color: #fff;
    overflow: hidden;
  }

  /* æ˜Ÿç©º & çƒŸèŠ±ç”»å¸ƒ */
  canvas {
    position: fixed;
    inset: 0;
    z-index: 1;
  }

  /* ä¸­é—´ç¤¼ç‰©ç›’ */
  .center {
    position: absolute;
    z-index: 2;
    width: 100%;
    top: 38%;
    text-align: center;
    pointer-events: none;
  }

  .gift-wrapper {
    display: inline-block;
    pointer-events: auto;
  }

  .gift {
    width: 140px;
    height: 120px;
    position: relative;
    cursor: pointer;
    animation: float 2.4s ease-in-out infinite;
  }

  .gift-box {
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 80px;
    background: linear-gradient(135deg, #ff5f6d, #ffc371);
    border-radius: 8px;
  }

  .gift-lid {
    position: absolute;
    top: 0;
    left: -6px;
    width: 152px;
    height: 40px;
    background: linear-gradient(135deg, #ff9966, #ff5e62);
    border-radius: 8px 8px 3px 3px;
    transform-origin: bottom center;
    transition: transform 0.5s ease, top 0.5s ease;
  }

  .gift-ribbon-vertical {
    position: absolute;
    left: 50%;
    top: -4px;
    width: 18px;
    height: 124px;
    background: rgba(255,255,255,0.85);
    transform: translateX(-50%);
    border-radius: 999px;
  }

  .gift-ribbon-horizontal {
    position: absolute;
    left: 0;
    bottom: 32px;
    width: 100%;
    height: 18px;
    background: rgba(255,255,255,0.85);
  }

  .gift-text {
    position: absolute;
    width: 100%;
    bottom: -36px;
    font-size: 16px;
    letter-spacing: 1px;
  }

  .tip {
    margin-top: 60px;
    font-size: 13px;
    opacity: 0.8;
  }

  @keyframes float {
    0%,100% { transform: translateY(0); }
    50% { transform: translateY(-10px); }
  }

  /* æ‰“å¼€åçš„ç¤¼ç‰©åŠ¨ç”» */
  .gift.opened {
    animation: none;
    transform: translateY(-6px) scale(1.03);
  }
  .gift.opened .gift-lid {
    top: -26px;
    transform: translateY(-8px) rotate(-18deg);
  }

  /* çˆ±å¿ƒç²’å­å®¹å™¨ */
  .hearts {
    position: absolute;
    left: 50%;
    top: -10px;
    transform: translateX(-50%);
    width: 0;
    height: 0;
    pointer-events: none;
  }

  .heart {
    position: absolute;
    width: 14px;
    height: 14px;
    background: #ff9ecb;
    transform: rotate(45deg);
    animation: heartFloat 2.4s ease-out forwards;
  }
  .heart::before, .heart::after {
    content: "";
    position: absolute;
    width: 14px;
    height: 14px;
    background: #ff9ecb;
    border-radius: 50%;
  }
  .heart::before { top: -7px; left: 0; }
  .heart::after  { left: -7px; top: 0; }

  @keyframes heartFloat {
    0% { transform: translate3d(0,0,0) rotate(45deg); opacity: 1; }
    100% { transform: translate3d(0,-60px,0) rotate(45deg); opacity: 0; }
  }

  /* å¼¹çª— */
  .modal {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.55);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 3;
  }
  .hidden { display: none; }

  .content {
    background: #fffaf4;
    color: #333;
    width: 82%;
    max-width: 380px;
    border-radius: 22px;
    padding: 26px 22px 20px;
    text-align: center;
    position: relative;
    overflow: hidden;
  }

  .content::before {
    content: "";
    position: absolute;
    inset: -40px;
    background:
      radial-gradient(circle at top left, #ffe1f0 0, transparent 55%),
      radial-gradient(circle at bottom right, #ffe7c9 0, transparent 55%);
    opacity: 0.85;
    z-index: -1;
  }

  .close {
    position: absolute;
    right: 14px;
    top: 10px;
    font-size: 24px;
    cursor: pointer;
    color: #888;
  }

  .cake { font-size: 42px; margin-bottom: 6px; }
  h2 { font-size: 20px; margin-bottom: 8px; }

  .wish {
    margin-top: 4px;
    color: #444;
    line-height: 1.8;
    white-space: pre-line;
  }

  .from {
    margin-top: 12px;
    color: #666;
    text-align: right;
    font-size: 12px;
  }

  .music-hint {
    margin-top: 10px;
    font-size: 11px;
    color: #999;
  }

  @media (max-width: 420px) {
    .gift {
      width: 120px;
      height: 110px;
    }
    .gift-lid { width: 132px; left: -6px; }
  }
</style>
</head>

<body>
<!-- æ˜Ÿç©º + çƒŸèŠ±ç”»å¸ƒ -->
<canvas id="canvas"></canvas>

<!-- ä¸­é—´ç¤¼ç‰©ç›’ -->
<div class="center">
  <div class="gift-wrapper">
    <div class="gift" id="giftBox">
      <div class="gift-lid"></div>
      <div class="gift-box"></div>
      <div class="gift-ribbon-vertical"></div>
      <div class="gift-ribbon-horizontal"></div>
      <div class="hearts" id="heartsContainer"></div>
      <div class="gift-text">ç‚¹å‡»æ‹†ç¤¼ç‰© ğŸ</div>
    </div>
  </div>
  <div class="tip">ä¸ºç‹æ€»å‡†å¤‡çš„ä¸“å±ç”Ÿæ—¥æ˜Ÿç©º âœ¨</div>
</div>

<!-- ç”Ÿæ—¥ç¥ç¦å¼¹çª— -->
<div class="modal hidden" id="modal">
  <div class="content">
    <div class="close" id="closeBtn">Ã—</div>
    <div class="cake">ğŸ‰ğŸ‚âœ¨</div>
    <h2>ç‹æ€»ï¼Œç”Ÿæ—¥å¿«ä¹ï¼</h2>
    <div class="wish">
æ„¿ä»Šæ™šçš„æ˜Ÿç©ºæ›¿æˆ‘ä¸ºä½ ç‚¹äº®æ¯ä¸€æŸçƒŸèŠ±ï¼Œ  
æ„¿æ‰€æœ‰çš„è¾›è‹¦éƒ½æœ‰å›ç”˜ï¼Œæ‰€æœ‰çš„æœŸå¾…éƒ½æœ‰ç­”æ¡ˆã€‚  

æ„¿ä½ äº‹ä¸šæœ‰æˆã€ç”Ÿæ´»æœ‰è¶£ã€èº«è¾¹æœ‰çˆ±ï¼Œ  
è¢«æ¸©æŸ”ä»¥å¾…ï¼Œä¹Ÿå­¦ä¼šæ¸©æŸ”åœ°å¯¹è‡ªå·±ã€‚  

æ–°çš„ä¸€å²ï¼Œè¯·ç»§ç»­å‘å…‰å‘çƒ­ï¼Œ  
ä¸–ç•Œä¼šå› ä¸ºä½ çš„å­˜åœ¨è€Œæ›´å¥½ä¸€ç‚¹ã€‚âœ¨
    </div>
    <div class="from">â€”â€” æ¥è‡ª å°é™ˆå°é™ˆ</div>
    <div class="music-hint">è‹¥æ²¡å¬åˆ°éŸ³ä¹ï¼Œå¯è½»ç‚¹å±å¹•ä¸€æ¬¡é‡æ–°æ¿€æ´»å“¦ ğŸ§</div>
  </div>
</div>

<!-- èƒŒæ™¯éŸ³ä¹ï¼ˆæŠŠ your-music.mp3 æ¢æˆä½ è‡ªå·±çš„æ­Œæ›²åœ°å€ï¼‰ -->
<audio id="bgm" loop>
  <source src="your-music.mp3" type="audio/mpeg" />
</audio>

<script>
/* ============ ç¤¼ç‰©ç›’ + å¼¹çª— + éŸ³ä¹ ============ */
const giftBox = document.getElementById("giftBox");
const modal   = document.getElementById("modal");
const closeBtn = document.getElementById("closeBtn");
const bgm = document.getElementById("bgm");
const heartsContainer = document.getElementById("heartsContainer");

// ç”Ÿæˆçˆ±å¿ƒå°ç²’å­
function createHeart() {
  const heart = document.createElement("div");
  heart.className = "heart";
  heart.style.left = (Math.random() * 40 - 20) + "px";
  heartsContainer.appendChild(heart);
  setTimeout(() => heart.remove(), 2400);
}

// æ‹†ç¤¼ç‰©
function openGift() {
  giftBox.classList.add("opened");
  modal.classList.remove("hidden");
  // æ’­æ”¾éŸ³ä¹ï¼ˆéƒ¨åˆ†æ‰‹æœºéœ€è¦ç”¨æˆ·äº¤äº’ï¼Œè¿™é‡Œå·²ç»å±äºç‚¹å‡»äº‹ä»¶ï¼‰
  if (bgm) {
    bgm.play().catch(()=>{ /* é™é»˜å¤±è´¥ */ });
  }
  // è¿ç»­ä¸€æ®µæ—¶é—´å†’çˆ±å¿ƒ
  for (let i = 0; i < 12; i++) {
    setTimeout(createHeart, i * 200);
  }
}

giftBox.addEventListener("click", openGift);
closeBtn.addEventListener("click", () => {
  modal.classList.add("hidden");
});

// é¢å¤–ç‚¹å‡»å±å¹•åå°è¯•é‡æ–°æ’­æ”¾éŸ³ä¹ï¼ˆé˜²æ­¢å¾®ä¿¡ç¬¬ä¸€æ¬¡å±è”½è‡ªåŠ¨æ’­æ”¾ï¼‰
document.addEventListener("touchstart", () => {
  if (bgm && bgm.paused) bgm.play().catch(()=>{});
}, { once: true });

/* ============ æ˜Ÿç©º + çƒŸèŠ±åŠ¨ç”» ============ */
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");
let w, h;

function resize() {
  w = canvas.width = window.innerWidth;
  h = canvas.height = window.innerHeight;
}
resize();
window.addEventListener("resize", resize);

// æ˜Ÿæ˜Ÿ
const stars = [];
for (let i = 0; i < 120; i++) {
  stars.push({
    x: Math.random() * w,
    y: Math.random() * h,
    r: Math.random() * 1.2 + 0.3,
    alpha: Math.random(),
    speed: Math.random() * 0.02 + 0.005
  });
}

// çƒŸèŠ±
const fireworks = [];

function random(min, max) {
  return Math.random() * (max - min) + min;
}

class Firework {
  constructor() {
    this.x = random(w * 0.1, w * 0.9);
    this.y = h;
    this.speed = random(3, 6);
    this.targetY = random(h * 0.15, h * 0.5);
    this.color = `hsl(${random(0,360)},100%,60%)`;
    this.exploded = false;
    this.particles = [];
  }

  explode() {
    const count = 40;
    for (let i = 0; i < count; i++) {
      this.particles.push({
        x: this.x,
        y: this.y,
        alpha: 1,
        radius: random(1.5, 3.5),
        angle: random(0, Math.PI * 2),
        speed: random(1, 4),
        color: this.color
      });
    }
    this.exploded = true;
  }

  update() {
    if (!this.exploded) {
      this.y -= this.speed;
      if (this.y <= this.targetY) this.explode();
    } else {
      this.particles.forEach(p => {
        p.x += Math.cos(p.angle) * p.speed;
        p.y += Math.sin(p.angle) * p.speed + 0.04; // è½»å¾®ä¸‹å 
        p.alpha -= 0.018;
      });
      this.particles = this.particles.filter(p => p.alpha > 0);
    }
  }

  draw() {
    if (!this.exploded) {
      ctx.beginPath();
      ctx.arc(this.x, this.y, 3, 0, Math.PI * 2);
      ctx.fillStyle = this.color;
      ctx.fill();
    } else {
      this.particles.forEach(p => {
        ctx.globalAlpha = p.alpha;
        ctx.fillStyle = p.color;
        ctx.beginPath();
        ctx.arc(p.x, p.y, p.radius, 0, Math.PI * 2);
        ctx.fill();
      });
      ctx.globalAlpha = 1;
    }
  }
}

function drawStars() {
  stars.forEach(s => {
    s.alpha += s.speed * (Math.random() > 0.5 ? 1 : -1);
    if (s.alpha < 0.1) s.alpha = 0.1;
    if (s.alpha > 1) s.alpha = 1;
    ctx.globalAlpha = s.alpha;
    ctx.beginPath();
    ctx.arc(s.x, s.y, s.r, 0, Math.PI * 2);
    ctx.fillStyle = "#ffffff";
    ctx.fill();
  });
  ctx.globalAlpha = 1;
}

function loop() {
  // å¤œç©ºèƒŒæ™¯
  ctx.fillStyle = "rgba(5, 8, 20, 0.6)";
  ctx.fillRect(0, 0, w, h);

  drawStars();

  // é€‚é‡ç”ŸæˆçƒŸèŠ±
  if (Math.random() < 0.045) {
    fireworks.push(new Firework());
  }

  fireworks.forEach((fw, i) => {
    fw.update();
    fw.draw();
    if (fw.exploded && fw.particles.length === 0) fireworks.splice(i, 1);
  });

  requestAnimationFrame(loop);
}
loop();
</script>
</body>
</html>
